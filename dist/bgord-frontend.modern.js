import*as e from"react";import t,{useRef as n,useEffect as r,useState as o,useLayoutEffect as a}from"react";import i from"tinykeys";function u(){return u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u.apply(this,arguments)}function s(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)t.indexOf(n=a[r])>=0||(o[n]=e[n]);return o}function l(e,t){const o=n(t);return r(()=>{o.current=e}),o.current}const c=["children"];var d;function f(e){var n;const r=null!=(n=e.duration)?n:300,[o,a]=t.useState(function(){return e.visible?e.isInitial?d.appeared:d.appearing:d.hidden}),i=l(o);return t.useEffect(()=>{if(!e.isInitial)if(e.visible)a(d.appearing),setTimeout(()=>a(d.appeared),100);else{if(!i)return;a(d.hidding),setTimeout(()=>a(d.hidden),r)}},[e.visible]),o===d.hidden?null:t.cloneElement(e.children,{"data-anima":o,"data-anima-effect":e.effect,style:u({"--duration":`${r}ms`},e.children.props.style)})}function v(e){return{"data-anima":e["data-anima"],"data-anima-effect":e["data-anima-effect"],style:e.style}}function m(e){const n=s(e,c),[r,o]=t.useState(!0);return t.useEffect(()=>o(!1),[]),t.createElement("ul",u({},n),e.children.map(e=>t.cloneElement(e,{isInitial:r})))}function p(e,n){var r;const o=null!=(r=null==n?void 0:n.direction)?r:"head",[a,i]=t.useState(e.map(e=>({item:e,props:{visible:!0}})));let s=[];for(const t of e)!a.map(e=>e.item).some(e=>t.id===e.id)&&s.push(t);t.useEffect(()=>{0!==s.length&&(i("head"===o?e=>[...s.map(e=>({item:e,props:{visible:!0}})),...e]:e=>[...e,...s.map(e=>({item:e,props:{visible:!0}}))]),s=[])},[s.length,o]);let l=[];for(const{item:t}of a)e.every(e=>e.id!==t.id)&&l.push(t);return t.useEffect(()=>{0!==l.length&&(i(e=>e.map(e=>l.some(t=>t.id===e.item.id)?u({},e,{props:{visible:!1}}):e)),l=[])},[l.length]),{items:a.map(t=>{const n=e.find(e=>e.id===t.item.id);return n?u({},t,{item:n}):t}),count:a.filter(e=>e.props.visible).length}}!function(e){e.appearing="appearing",e.appeared="appeared",e.hidding="hidding",e.hidden="hidden"}(d||(d={}));class h{static format(e){const t=Math.floor(e/60),n=e%60;return`${String(t).padStart(2,"0")}:${String(n).padStart(2,"0")}`}}function g(e){const t="function"==typeof e?e():e,[n,r]=o(t);return{value:n,set:r,clear:function(){r(t)}}}const w=1;function y(t){const[n,r]=e.useState("initial"),o=e.useRef(null),a=g(0),i=g(0),u=g(1),s=0===u.value,l=0===a.value?0:Math.round(i.value/a.value*100);function c(e){const t=e.currentTarget;o.current&&(o.current.currentTime=t.valueAsNumber,i.set(t.valueAsNumber))}function d(e){const t=e.currentTarget;o.current&&(o.current.volume=t.valueAsNumber,u.set(t.valueAsNumber))}return{props:{audio:{src:t,onTimeUpdate:function(e){i.set(Math.round(e.target.currentTime))},onLoadedMetadata:function(e){const t=e.currentTarget;o.current=t,a.set(Math.round(t.duration)),i.set(t.currentTime),u.set(t.volume),r("ready")},onEnded:function(){r("paused")},controls:!1},player:{min:0,step:1,max:a.value,value:i.value,onInput:c,style:{"--percentage":`${l}%`}},volume:{min:0,max:1,value:u.value,onInput:d,style:{"--percentage":`${Math.floor(100*u.value)}%`}}},actions:{play:function(){o.current&&(o.current.play(),r("playing"))},pause:function(){o.current&&(o.current.pause(),r("paused"))},mute:function(){o.current&&(o.current.volume=0,u.set(0))},unmute:function(){o.current&&(o.current.volume=1,u.set(1))},reset:function(){o.current&&(o.current.currentTime=0,o.current.pause(),i.set(0),r("paused"))},seek:c,changeVolume:d},meta:{state:n,percentage:{raw:l,formatted:`${l}%`},currentTime:{raw:i.value,formatted:h.format(i.value)},duration:{raw:a.value,formatted:h.format(a.value)},volume:{value:u.value,raw:Math.floor(100*u.value),formatted:`${Math.floor(100*u.value)}%`},muted:s}}}function b(e){t.useEffect(()=>{var t;e.condition&&(null==(t=e.ref.current)||t.focus())},[e.condition])}function E(){if("undefined"!=typeof window)return window}function S(){const[e,t]=o({width:void 0,height:void 0});return r(()=>{const e=E();if(e)return e.addEventListener("resize",n),n(),()=>e.removeEventListener("resize",n);function n(){t({width:null==e?void 0:e.innerWidth,height:null==e?void 0:e.innerHeight})}},[]),e}function x(e){var t;const n=S();return(null!=(t=null==n?void 0:n.width)?t:0)<=e}function L(e,n,r){t.useEffect(()=>{if(e.current)return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t);function t(t){var o;null!=(o=e.current)&&o.contains(t.target)||(null==r?void 0:r.some(e=>{var n;return null==(n=e.current)?void 0:n.contains(t.target)}))||n()}},[n,e,r])}function T(){const[e,t]=o("");return{query:e,clear:function(){t("")},onChange:function(e){t(e.currentTarget.value)},filterFn:function(t){return""===e||(null==t?void 0:t.toLowerCase().includes(e.toLowerCase()))}}}function F(e){t.useEffect(()=>{document.title=e},[e])}var M,C;function $(e){const t=e.length-e.max,n=e.length>e.max;function a(){return n?M.contracted:M.expanded}const[i,u]=o(a);return r(()=>u(a()),[e.length,e.max]),{state:i,displayShowMore:i===M.contracted,displayShowLess:i===M.expanded&&n,showMore:function(){i===M.contracted&&u(M.expanded)},showLess:function(){i===M.expanded&&u(M.contracted)},numberOfExcessiveElements:t,filterFn:function(t,n){return i===M.expanded||n<e.max}}}function O(e){var t;const n=null!=(t=null==e?void 0:e.maxSize)?t:Infinity,[r,a]=o(C.idle),[i,u]=o(null);function s(e){const t=e.currentTarget.files;if(!t||!t[0])return;const r=t[0];if(!(r.size>n))return u(r),a(C.selected),r;a(C.error)}function l(){u(null),a(C.idle)}return r===C.idle?{state:r,data:null,actions:{selectFile:s,clearFile:l}}:r===C.selected?{state:r,data:i,actions:{selectFile:s,clearFile:l,previewFile:function(){if(i)return URL.createObjectURL(i)}}}:{state:r,data:null,actions:{selectFile:s,clearFile:l}}}function k(){}function j(e){var t,n,a;const i=null!=(t=e.defaultQuery)?t:void 0,u=null!=(n=e.filterFn)?n:function(e){return void 0===d||d===String(e)},s=Object.keys(e.enum),c=null!=(a=null==e?void 0:e.onUpdate)?a:k,[d,f]=o(i),v=l(d);return r(()=>{c(d,v)},[v,d]),{query:d,clear:function(){f(i)},onChange:function(t){const n=t.currentTarget.value,r=Boolean(e.enum[String(n)]);f(r?n:void 0)},filterFn:u,options:s,onUpdate:c}}!function(e){e.contracted="contracted",e.expanded="expanded"}(M||(M={})),function(e){e.idle="idle",e.selected="selected",e.error="error"}(C||(C={}));const P={width:null,height:null};async function U(e){if(!e)return P;const t=document.createElement("img"),n=new Promise((e,n)=>{t.onload=()=>e({width:t.width,height:t.height}),t.onerror=n});return t.src=e,n}function A(t){var n;const r=g(P);return e.useEffect(()=>{!async function(){if(t.state===C.selected)try{const e=await U(t.actions.previewFile());return r.set(e)}catch(e){return r.clear()}[C.error,C.idle].includes(t.state)&&null!==r.value.width&&null!==r.value.height&&r.clear()}()},[t.state,null==(n=t.data)?void 0:n.name]),r.value}function I(e=!1){const[t,n]=o(e);return{on:t,off:!t,enable:()=>n(!0),disable:()=>n(!1),toggle:()=>n(e=>!e)}}const R=()=>{const e=I("undefined"==typeof navigator||"boolean"!=typeof navigator.onLine||navigator.onLine);return t.useEffect(()=>{function t(){e.enable()}function n(){e.disable()}return window.addEventListener("online",t),window.addEventListener("offline",n),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",n)}},[]),e.on};function N(e){t.useEffect(()=>{const t=i(window,e);return()=>t()},[e])}function z(e=!1){t.useEffect(()=>{if(e)return window.addEventListener("beforeunload",t),()=>window.removeEventListener("beforeunload",t);function t(e){e.preventDefault()}},[e])}function D(e){var t,n;const r=null!=(t=null==e?void 0:e.defaultItems)?t:[],a=null!=(n=null==e?void 0:e.comparisonFn)?n:(e,t)=>e===t,[i,u]=o(r);function s(e){u(t=>Array.isArray(e)?[...t,...e]:[...t,e])}function l(e){u(t=>t.filter(t=>!a(t,e)))}function c(e){return i.some(t=>a(t,e))}return[i,{clear:function(){u([])},add:s,remove:l,toggle:function(e){c(e)?l(e):s(e)},isAdded:c,update:u}]}function q(e=!0){a(()=>{if(!e)return;const t=document.querySelector("html"),n=document.body,r=window.getComputedStyle(n).overflow,o=window.getComputedStyle(t).overflow;return n.style.overflow="hidden",t.style.overflow="hidden",()=>{n.style.overflow=r,t.style.overflow=o}},[e])}function H(e){const t=E();return new URLSearchParams(null==t?void 0:t.location.search).get(e.label),j(u({onUpdate:(n,r)=>{if(!t)return;const o=new URL(t.location.toString()),a=new URLSearchParams(o.search);void 0===n?a.delete(e.label):a.set(e.label,n),n!==r&&n!==r&&(o.search=a.toString(),history.pushState({},"",o.toString()))}},e,{defaultQuery:e.defaultQuery}))}const Q=["disable","enable","on","off","toggle"];function _(e){const{disable:n}=e,r=s(e,Q),o=t.useRef(null);return t.useEffect(()=>{var t,n;e.on?null==(t=o.current)||t.showModal():null==(n=o.current)||n.close()},[e.on]),N({Escape:n}),b({ref:o,condition:e.on}),q(e.on),t.createElement("dialog",u({ref:o,tabIndex:0,"data-display":e.on?"flex":"none","data-direction":"column","data-mx":"auto","data-p":"24","data-position":"absolute","data-z":"2","data-bg":"white","data-br":"4","data-bc":"gray-300","data-bw":"1","data-backdrop":"black"},r))}function B(e){return R()?null:t.createElement(t.Fragment,null,e.children)}const V=["as"];function W(e){const{as:n}=e,r=s(e,V);return t.createElement(n||"a",u({target:"_blank",rel:"noreferer noopener"},r))}const Y=e=>console.warn("Copying to clipboard not supported");async function G(e){var t,n;const r=null!=(t=e.onFailure)?t:Y,o=null!=(n=e.onSuccess)?n:k;navigator.clipboard||r();try{await navigator.clipboard.writeText(e.text),o()}catch(e){r(e)}}class J{static datetime(e,t="N/A"){return e?new Date(e).toLocaleString():t}static form(e){return e?`${String(e.getFullYear()).padStart(2,"0")}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`:J.form(new Date)}}class K{constructor(e,t){this.value=void 0;const n=new URLSearchParams(this.getNonEmptyFilters(t));this.value=""!==n.toString()?`${e}?${n.toString()}`:e}getNonEmptyFilters(e){return void 0===e?{}:Object.fromEntries(Object.entries(e).filter(([e,t])=>void 0!==t))}}function X(){return!E()}class Z{static extract(e){var t,n,r;return null!=(t=null==(n=e.data)||null==(r=n.pages)?void 0:r.flat().map(e=>e.result).flat())?t:[]}}function ee(e){var t;if("en"!==e.language)return console.warn(`[@bgord/frontend] missing pluralization fuction for language ${e.language}.`),e.singular;const n=null!=(t=e.plural)?t:`${e.singular}s`;return 1===e.value?e.singular:n}Z.empty={result:[],meta:{exhausted:!0}};class te{constructor(e){this.message=void 0,this._known=!0,this.message=e.message}static isServerError(e){return!!(e&&"object"==typeof e&&e===Object(e)&&e.hasOwnProperty("_known")&&e.hasOwnProperty("message"))}static async extract(e){if(e.ok)return e;const t=await e.json(),n=te.isServerError(t)?t.message:"app.error.general";throw new te({message:n})}static async handle(e){throw new te({message:te.isServerError(e)?e.message:"app.error.general"})}}class ne{constructor(e){this.value=void 0,this.value=e}toHours(){return 24*this.value}toMinutes(){return 24*this.value*60}toSeconds(){return 24*this.value*60*60}toMs(){return 24*this.value*60*60*1e3}}class re{constructor(e){this.value=void 0,this.value=e}toMinutes(){return 60*this.value}toSeconds(){return 60*this.value*60}toMs(){return 60*this.value*60*1e3}}class oe{constructor(e){this.value=void 0,this.value=e}toSeconds(){return 60*this.value}toMs(){return 60*this.value*1e3}}class ae{constructor(e){this.value=void 0,this.value=e}toMs(){return 1e3*this.value}}const ie={Days:ne,Hours:re,Minutes:oe,Seconds:ae},ue=t.createContext(void 0);function se(e){const[n,r]=function(){var t;const n=null!=(t=null==e?void 0:e.timeout)?t:5e3,[r,o]=D({comparisonFn:(e,t)=>e.id===t.id});return[[...r].reverse(),{add:function(e){const t=u({},e,{id:String(Date.now())});o.add(t),setTimeout(()=>o.remove(t),n)},remove:o.remove,clear:o.clear}]}();return t.createElement(ue.Provider,{value:[n,r]},e.children)}function le(){const e=t.useContext(ue);if(void 0===e)throw new Error("useToasts must be used within the ToastsContextProvider");return e}function ce(){const[,e]=le();return e.add}const de=t.createContext({translations:{},language:"en"});function fe(e){return t.createElement(de.Provider,{value:e.value},e.children)}function ve(){const e=t.useContext(de);if(void 0===e)throw new Error("useTranslations must be used within the TranslationsContext");return function(t){const n=e.translations[t];return n||console.warn(`[@bgord/frontend] missing translation for key ${t}.`),null!=n?n:t}}function me(){const e=t.useContext(de);if(void 0===e)throw new Error("useLanguage must be used within the TranslationsContext");return e.language}function pe(){const e=me();return t=>ee(u({},t,{language:e}))}export{w as AUDIO_DEFAULT_VOLUME,f as Anima,m as AnimaList,d as AnimaState,J as DateFormatter,ne as Days,_ as Dialog,h as DurationFormatter,K as FilterUrl,re as Hours,oe as Minutes,B as OfflineIndicator,W as OutboundLink,Z as Pagination,ae as Seconds,te as ServerError,ie as Time,se as ToastsContextProvider,fe as TranslationsContextProvider,M as UseExpandableListState,C as UseFileState,G as copyToClipboard,P as emptyImageResolution,v as getAnimaProps,U as getImageResolution,E as getSafeWindow,X as isClient,k as noop,ee as pluralize,p as useAnimaList,y as useAudio,b as useAutofocus,x as useBreakpoint,L as useClickOutside,T as useClientSearch,F as useDocumentTitle,$ as useExpandableList,g as useField,O as useFile,j as useFilter,A as useImageFileResolution,R as useIsOnline,N as useKeyboardShortcurts,me as useLanguage,z as useLeavingPrompt,D as useList,pe as usePluralize,l as usePreviousValue,q as useScrollLock,ce as useToastTrigger,le as useToastsContext,I as useToggle,ve as useTranslations,H as useUrlFilter,S as useWindowDimensions};
//# sourceMappingURL=bgord-frontend.modern.js.map
