import*as e from"react";import t,{useRef as n,useEffect as r,useState as o,useLayoutEffect as i}from"react";import a from"tinykeys";function s(){return s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s.apply(this,arguments)}function u(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)t.indexOf(n=i[r])>=0||(o[n]=e[n]);return o}function l(e,t){const o=n(t);return r(()=>{o.current=e}),o.current}const c=["children"];var d,f,v;function h(e){var n;const r=null!=(n=e.duration)?n:300,[o,i]=t.useState(function(){return e.visible?e.isInitial?d.appeared:d.appearing:d.hidden}),a=l(o);return t.useEffect(()=>{if(!e.isInitial)if(e.visible)i(d.appearing),setTimeout(()=>i(d.appeared),100);else{if(!a)return;i(d.hidding),setTimeout(()=>i(d.hidden),r)}},[e.visible]),o===d.hidden?null:t.cloneElement(e.children,{"data-anima":o,"data-anima-effect":e.effect,style:s({"--duration":`${r}ms`},e.children.props.style)})}function m(e){return{"data-anima":e["data-anima"],"data-anima-effect":e["data-anima-effect"],style:e.style}}function g(e){const n=u(e,c),[r,o]=t.useState(!0);return t.useEffect(()=>o(!1),[]),t.createElement("ul",s({},n),e.children.map(e=>t.cloneElement(e,{isInitial:r})))}function p(e,n){var r;const o=null!=(r=null==n?void 0:n.direction)?r:"head",[i,a]=t.useState(e.map(e=>({item:e,props:{visible:!0}})));let u=[];for(const t of e)!i.map(e=>e.item).some(e=>t.id===e.id)&&u.push(t);t.useEffect(()=>{0!==u.length&&(a("head"===o?e=>[...u.map(e=>({item:e,props:{visible:!0}})),...e]:e=>[...e,...u.map(e=>({item:e,props:{visible:!0}}))]),u=[])},[u.length,o]);let l=[];for(const{item:t}of i)e.every(e=>e.id!==t.id)&&l.push(t);return t.useEffect(()=>{0!==l.length&&(a(e=>e.map(e=>l.some(t=>t.id===e.item.id)?s({},e,{props:{visible:!1}}):e)),l=[])},[l.length]),{items:i.map(t=>{const n=e.find(e=>e.id===t.item.id);return n?s({},t,{item:n}):t}),count:i.filter(e=>e.props.visible).length}}function w(e){t.useEffect(()=>{var t;e.condition&&(null==(t=e.ref.current)||t.focus())},[e.condition])}function y(){if("undefined"!=typeof window)return window}function b(){const[e,t]=o({width:void 0,height:void 0});return r(()=>{const e=y();if(e)return e.addEventListener("resize",n),n(),()=>e.removeEventListener("resize",n);function n(){t({width:null==e?void 0:e.innerWidth,height:null==e?void 0:e.innerHeight})}},[]),e}function E(e){var t;const n=b();return(null!=(t=null==n?void 0:n.width)?t:0)<=e}function x(e,n,r){t.useEffect(()=>{if(e.current)return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t);function t(t){var o;null!=(o=e.current)&&o.contains(t.target)||(null==r?void 0:r.some(e=>{var n;return null==(n=e.current)?void 0:n.contains(t.target)}))||n()}},[n,e,r])}function S(){const[e,t]=o("");return{query:e,clear:function(){t("")},onChange:function(e){t(e.currentTarget.value)},filterFn:function(t){return""===e||(null==t?void 0:t.toLowerCase().includes(e.toLowerCase()))}}}function L(e){t.useEffect(()=>{document.title=e},[e])}function F(e){const t=e.length-e.max,n=e.length>e.max;function i(){return n?f.contracted:f.expanded}const[a,s]=o(i);return r(()=>s(i()),[e.length,e.max]),{state:a,displayShowMore:a===f.contracted,displayShowLess:a===f.expanded&&n,showMore:function(){a===f.contracted&&s(f.expanded)},showLess:function(){a===f.expanded&&s(f.contracted)},numberOfExcessiveElements:t,filterFn:function(t,n){return a===f.expanded||n<e.max}}}function C(e){const[t,n]=o(e),i="function"==typeof e?e():e;return r(()=>{n(i)},[i]),{value:t,set:n,clear:function(){n(e)}}}function O(e){var t;const n=null!=(t=null==e?void 0:e.maxSize)?t:Infinity,[r,i]=o(v.idle),[a,s]=o(null);function u(e){const t=e.currentTarget.files;if(!t||!t[0])return;const r=t[0];if(!(r.size>n))return s(r),i(v.selected),r;i(v.error)}function l(){s(null),i(v.idle)}return r===v.idle?{state:r,data:null,actions:{selectFile:u,clearFile:l}}:r===v.selected?{state:r,data:a,actions:{selectFile:u,clearFile:l,previewFile:function(){if(a)return URL.createObjectURL(a)}}}:{state:r,data:null,actions:{selectFile:u,clearFile:l}}}function T(){}function j(e){var t,n,i;const a=null!=(t=e.defaultQuery)?t:void 0,s=null!=(n=e.filterFn)?n:function(e){return void 0===d||d===String(e)},u=Object.keys(e.enum),c=null!=(i=null==e?void 0:e.onUpdate)?i:T,[d,f]=o(a),v=l(d);return r(()=>{c(d,v)},[v,d]),{query:d,clear:function(){f(a)},onChange:function(t){const n=t.currentTarget.value,r=Boolean(e.enum[String(n)]);f(r?n:void 0)},filterFn:s,options:u,onUpdate:c}}function P(e=!1){const[t,n]=o(e);return{on:t,off:!t,enable:()=>n(!0),disable:()=>n(!1),toggle:()=>n(e=>!e)}}!function(e){e.appearing="appearing",e.appeared="appeared",e.hidding="hidding",e.hidden="hidden"}(d||(d={})),function(e){e.contracted="contracted",e.expanded="expanded"}(f||(f={})),function(e){e.idle="idle",e.selected="selected",e.error="error"}(v||(v={}));const k=()=>{const e=P("undefined"==typeof navigator||"boolean"!=typeof navigator.onLine||navigator.onLine);return t.useEffect(()=>{function t(){e.enable()}function n(){e.disable()}return window.addEventListener("online",t),window.addEventListener("offline",n),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",n)}},[]),e.on};function M(e){t.useEffect(()=>{const t=a(window,e);return()=>t()},[e])}function U(e=!1){t.useEffect(()=>{if(e)return window.addEventListener("beforeunload",t),()=>window.removeEventListener("beforeunload",t);function t(e){e.preventDefault()}},[e])}function z(e){var t,n;const r=null!=(t=null==e?void 0:e.defaultItems)?t:[],i=null!=(n=null==e?void 0:e.comparisonFn)?n:(e,t)=>e===t,[a,s]=o(r);function u(e){s(t=>Array.isArray(e)?[...t,...e]:[...t,e])}function l(e){s(t=>t.filter(t=>!i(t,e)))}function c(e){return a.some(t=>i(t,e))}return[a,{clear:function(){s([])},add:u,remove:l,toggle:function(e){c(e)?l(e):u(e)},isAdded:c,update:s}]}function R(e=!0){i(()=>{if(!e)return;const t=document.querySelector("html"),n=document.body,r=window.getComputedStyle(n).overflow,o=window.getComputedStyle(t).overflow;return n.style.overflow="hidden",t.style.overflow="hidden",()=>{n.style.overflow=r,t.style.overflow=o}},[e])}function D(e){const t=y();return new URLSearchParams(null==t?void 0:t.location.search).get(e.label),j(s({onUpdate:(n,r)=>{if(!t)return;const o=new URL(t.location.toString()),i=new URLSearchParams(o.search);void 0===n?i.delete(e.label):i.set(e.label,n),n!==r&&n!==r&&(o.search=i.toString(),history.pushState({},"",o.toString()))}},e,{defaultQuery:e.defaultQuery}))}const I={width:null,height:null};async function $(e){if(!e)return I;const t=document.createElement("img"),n=new Promise((e,n)=>{t.onload=()=>e({width:t.width,height:t.height}),t.onerror=n});return t.src=e,n}function A(t){const n=C(I);return e.useEffect(()=>{!async function(){if(t.state===v.selected)try{const e=await $(t.actions.previewFile());return n.set(e)}catch(e){return n.clear()}[v.error,v.idle].includes(t.state)&&null!==n.value.width&&null!==n.value.height&&n.clear()}()},[t.state]),n.value}const q=["DialogOverlay","disable","enable","on","off","toggle"];function H(e){const{DialogOverlay:n,disable:r}=e,o=u(e,q),i=t.useRef(null);return M({Escape:r}),x(i,r),w({ref:i,condition:e.on}),R(e.on),e.off?null:t.createElement(t.Fragment,null,null!=n?n:t.createElement(N,null),t.createElement("dialog",s({ref:i,tabIndex:0,open:e.on,"data-display":"flex","data-direction":"column","data-position":"absolute","data-z":"2","data-bg":"white","data-br":"4","data-bc":"gray-300","data-bw":"1","data-p":"24","data-mx":"auto"},o)))}function N(e){return t.createElement("div",s({"data-position":"absolute","data-inset":"0","data-display":"flex","data-main":"cross","data-cross":"center","data-z":"2",style:{background:"rgb(0, 0, 0, 0.75)"}},e))}function Q(e){return k()?null:t.createElement(t.Fragment,null,e.children)}const _=["as"];function B(e){const{as:n}=e,r=u(e,_);return t.createElement(n||"a",s({target:"_blank",rel:"noreferer noopener"},r))}const W=e=>console.warn("Copying to clipboard not supported");async function G(e){var t,n;const r=null!=(t=e.onFailure)?t:W,o=null!=(n=e.onSuccess)?n:T;navigator.clipboard||r();try{await navigator.clipboard.writeText(e.text),o()}catch(e){r(e)}}class J{static datetime(e,t="N/A"){return e?new Date(e).toLocaleString():t}}class K{constructor(e,t){this.value=void 0;const n=new URLSearchParams(this.getNonEmptyFilters(t));this.value=""!==n.toString()?`${e}?${n.toString()}`:e}getNonEmptyFilters(e){return void 0===e?{}:Object.fromEntries(Object.entries(e).filter(([e,t])=>void 0!==t))}}class V{static extract(e){var t,n,r;return null!=(t=null==(n=e.data)||null==(r=n.pages)?void 0:r.flat().map(e=>e.result).flat())?t:[]}}function X(e){var t;if("en"!==e.language)return console.warn(`[@bgord/frontend] missing pluralization fuction for language ${e.language}.`),e.singular;const n=null!=(t=e.plural)?t:`${e.singular}s`;return 1===e.value?e.singular:n}V.empty={result:[],meta:{exhausted:!0}};class Y{constructor(e){this.message=void 0,this._known=!0,this.message=e.message}static isServerError(e){return!!(e&&"object"==typeof e&&e===Object(e)&&e.hasOwnProperty("_known")&&e.hasOwnProperty("message"))}static async extract(e){if(e.ok)return e;const t=await e.json(),n=Y.isServerError(t)?t.message:"app.error.general";throw new Y({message:n})}static async handle(e){throw new Y({message:Y.isServerError(e)?e.message:"app.error.general"})}}class Z{constructor(e){this.value=void 0,this.value=e}toHours(){return 24*this.value}toMinutes(){return 24*this.value*60}toSeconds(){return 24*this.value*60*60}toMs(){return 24*this.value*60*60*1e3}}class ee{constructor(e){this.value=void 0,this.value=e}toMinutes(){return 60*this.value}toSeconds(){return 60*this.value*60}toMs(){return 60*this.value*60*1e3}}class te{constructor(e){this.value=void 0,this.value=e}toSeconds(){return 60*this.value}toMs(){return 60*this.value*1e3}}class ne{constructor(e){this.value=void 0,this.value=e}toMs(){return 1e3*this.value}}const re={Days:Z,Hours:ee,Minutes:te,Seconds:ne},oe=t.createContext(void 0);function ie(e){const[n,r]=function(){var t;const n=null!=(t=null==e?void 0:e.timeout)?t:5e3,[r,o]=z({comparisonFn:(e,t)=>e.id===t.id});return[[...r].reverse(),{add:function(e){const t=s({},e,{id:String(Date.now())});o.add(t),setTimeout(()=>o.remove(t),n)},remove:o.remove,clear:o.clear}]}();return t.createElement(oe.Provider,{value:[n,r]},e.children)}function ae(){const e=t.useContext(oe);if(void 0===e)throw new Error("useToasts must be used within the ToastsContextProvider");return e}function se(){const[,e]=ae();return e.add}const ue=t.createContext({translations:{},language:"en"});function le(e){return t.createElement(ue.Provider,{value:e.value},e.children)}function ce(){const e=t.useContext(ue);if(void 0===e)throw new Error("useTranslations must be used within the TranslationsContext");return function(t){const n=e.translations[t];return n||console.warn(`[@bgord/frontend] missing translation for key ${t}.`),null!=n?n:t}}function de(){const e=t.useContext(ue);if(void 0===e)throw new Error("useLanguage must be used within the TranslationsContext");return e.language}function fe(){const e=de();return t=>X(s({},t,{language:e}))}export{h as Anima,g as AnimaList,d as AnimaState,J as DateFormatter,Z as Days,N as DefaultDialogOverlay,H as Dialog,K as FilterUrl,ee as Hours,te as Minutes,Q as OfflineIndicator,B as OutboundLink,V as Pagination,ne as Seconds,Y as ServerError,re as Time,ie as ToastsContextProvider,le as TranslationsContextProvider,f as UseExpandableListState,v as UseFileState,G as copyToClipboard,I as emptyImageResolution,m as getAnimaProps,$ as getImageResolution,y as getSafeWindow,T as noop,X as pluralize,p as useAnimaList,w as useAutofocus,E as useBreakpoint,x as useClickOutside,S as useClientSearch,L as useDocumentTitle,F as useExpandableList,C as useField,O as useFile,j as useFilter,A as useImageFileResolution,k as useIsOnline,M as useKeyboardShortcurts,de as useLanguage,U as useLeavingPrompt,z as useList,fe as usePluralize,l as usePreviousValue,R as useScrollLock,se as useToastTrigger,ae as useToastsContext,P as useToggle,ce as useTranslations,D as useUrlFilter,b as useWindowDimensions};
//# sourceMappingURL=bgord-frontend.modern.js.map
