import*as n from"react";import e,{useRef as t,useEffect as r,useState as o,useLayoutEffect as u}from"react";import i from"tinykeys";function a(){return a=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},a.apply(this,arguments)}function c(n,e){if(null==n)return{};var t,r,o={},u=Object.keys(n);for(r=0;r<u.length;r++)e.indexOf(t=u[r])>=0||(o[t]=n[t]);return o}function l(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function f(n,e){var t="undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(t)return(t=t.call(n)).next.bind(t);if(Array.isArray(n)||(t=function(n,e){if(n){if("string"==typeof n)return l(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);return"Object"===t&&n.constructor&&(t=n.constructor.name),"Map"===t||"Set"===t?Array.from(n):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?l(n,e):void 0}}(n))||e&&n&&"number"==typeof n.length){t&&(n=t);var r=0;return function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function s(n,e){var o=t(e);return r(function(){o.current=n}),o.current}var d,v=["children"];function m(n){var t,r=null!=(t=n.duration)?t:300,o=e.useState(function(){return n.visible?n.isInitial?d.appeared:d.appearing:d.hidden}),u=o[0],i=o[1],c=s(u);return e.useEffect(function(){if(!n.isInitial)if(n.visible)i(d.appearing),setTimeout(function(){return i(d.appeared)},100);else{if(!c)return;i(d.hidding),setTimeout(function(){return i(d.hidden)},r)}},[n.visible]),u===d.hidden?null:e.cloneElement(n.children,{"data-anima":u,"data-anima-effect":n.effect,style:a({"--duration":r+"ms"},n.children.props.style)})}function h(n){return{"data-anima":n["data-anima"],"data-anima-effect":n["data-anima-effect"],style:n.style}}function p(n){var t=c(n,v),r=e.useState(!0),o=r[0],u=r[1];return e.useEffect(function(){return u(!1)},[]),e.createElement("ul",a({},t),n.children.map(function(n){return e.cloneElement(n,{isInitial:o})}))}function g(n,t){for(var r,o,u=null!=(r=null==t?void 0:t.direction)?r:"head",i=e.useState(n.map(function(n){return{item:n,props:{visible:!0}}})),c=i[0],l=i[1],s=[],d=function(){var n=o.value;!c.map(function(n){return n.item}).some(function(e){return n.id===e.id})&&s.push(n)},v=f(n);!(o=v()).done;)d();e.useEffect(function(){0!==s.length&&(l("head"===u?function(n){return[].concat(s.map(function(n){return{item:n,props:{visible:!0}}}),n)}:function(n){return[].concat(n,s.map(function(n){return{item:n,props:{visible:!0}}}))}),s=[])},[s.length,u]);for(var m,h=[],p=function(){var e=m.value.item;n.every(function(n){return n.id!==e.id})&&h.push(e)},g=f(c);!(m=g()).done;)p();return e.useEffect(function(){0!==h.length&&(l(function(n){return n.map(function(n){return h.some(function(e){return e.id===n.item.id})?a({},n,{props:{visible:!1}}):n})}),h=[])},[h.length]),{items:c.map(function(e){var t=n.find(function(n){return n.id===e.item.id});return t?a({},e,{item:t}):e}),count:c.filter(function(n){return n.props.visible}).length}}!function(n){n.appearing="appearing",n.appeared="appeared",n.hidding="hidding",n.hidden="hidden"}(d||(d={}));var w=/*#__PURE__*/function(){function n(){}return n.format=function(n){var e=Math.floor(n/60),t=n%60;return String(e).padStart(2,"0")+":"+String(t).padStart(2,"0")},n}();function y(n){var e="function"==typeof n?n():n,t=o(e),r=t[1];return{value:t[0],set:r,clear:function(){r(e)}}}var b,E,S=1;function x(e){var t=n.useRef(null),r=y(0),o=y(0),u=y(1),i=0===u.value;function a(n){var e=n.currentTarget;t.current&&(t.current.currentTime=e.valueAsNumber,o.set(e.valueAsNumber))}function c(n){var e=n.currentTarget;t.current&&(t.current.volume=e.valueAsNumber,u.set(e.valueAsNumber))}return{props:{audio:{src:e,onTimeUpdate:function(n){o.set(Math.round(n.target.currentTime))},onLoadedMetadata:function(n){var e=n.currentTarget;t.current=e,r.set(Math.round(e.duration)),o.set(e.currentTime),u.set(e.volume)},controls:!1},player:{min:0,step:1,max:r.value,value:o.value,onInput:a},volume:{min:0,max:1,value:u.value,onInput:c}},actions:{play:function(){t.current&&t.current.play()},pause:function(){t.current&&t.current.pause()},mute:function(){t.current&&(t.current.volume=0,u.set(0))},unmute:function(){t.current&&(t.current.volume=1,u.set(1))},reset:function(){t.current&&(t.current.currentTime=0,t.current.pause(),o.set(0))},seek:a,changeVolume:c},meta:{currentTime:{raw:o.value,formatted:w.format(o.value)},duration:{raw:r.value,formatted:w.format(r.value)},volume:{raw:u.value,formatted:Math.floor(100*u.value)},muted:i}}}function L(n){e.useEffect(function(){var e;n.condition&&(null==(e=n.ref.current)||e.focus())},[n.condition])}function P(){if("undefined"!=typeof window)return window}function T(){var n=o({width:void 0,height:void 0}),e=n[0],t=n[1];return r(function(){var n=P();if(n)return n.addEventListener("resize",e),e(),function(){return n.removeEventListener("resize",e)};function e(){t({width:null==n?void 0:n.innerWidth,height:null==n?void 0:n.innerHeight})}},[]),e}function F(n){var e,t=T();return(null!=(e=null==t?void 0:t.width)?e:0)<=n}function j(n,t,r){e.useEffect(function(){if(n.current)return document.addEventListener("mousedown",e),function(){return document.removeEventListener("mousedown",e)};function e(e){var o;null!=(o=n.current)&&o.contains(e.target)||(null==r?void 0:r.some(function(n){var t;return null==(t=n.current)?void 0:t.contains(e.target)}))||t()}},[t,n,r])}function O(){var n=o(""),e=n[0],t=n[1];return{query:e,clear:function(){t("")},onChange:function(n){t(n.currentTarget.value)},filterFn:function(n){return""===e||(null==n?void 0:n.toLowerCase().includes(e.toLowerCase()))}}}function C(n){e.useEffect(function(){document.title=n},[n])}function M(n){var e=n.length-n.max,t=n.length>n.max;function u(){return t?b.contracted:b.expanded}var i=o(u),a=i[0],c=i[1];return r(function(){return c(u())},[n.length,n.max]),{state:a,displayShowMore:a===b.contracted,displayShowLess:a===b.expanded&&t,showMore:function(){a===b.contracted&&c(b.expanded)},showLess:function(){a===b.expanded&&c(b.contracted)},numberOfExcessiveElements:e,filterFn:function(e,t){return a===b.expanded||t<n.max}}}function A(n){var e,t=null!=(e=null==n?void 0:n.maxSize)?e:Infinity,r=o(E.idle),u=r[0],i=r[1],a=o(null),c=a[0],l=a[1];function f(n){var e=n.currentTarget.files;if(e&&e[0]){var r=e[0];if(!(r.size>t))return l(r),i(E.selected),r;i(E.error)}}function s(){l(null),i(E.idle)}return u===E.idle?{state:u,data:null,actions:{selectFile:f,clearFile:s}}:u===E.selected?{state:u,data:c,actions:{selectFile:f,clearFile:s,previewFile:function(){if(c)return URL.createObjectURL(c)}}}:{state:u,data:null,actions:{selectFile:f,clearFile:s}}}function I(){}function U(n){var e,t,u,i=null!=(e=n.defaultQuery)?e:void 0,a=null!=(t=n.filterFn)?t:function(n){return void 0===d||d===String(n)},c=Object.keys(n.enum),l=null!=(u=null==n?void 0:n.onUpdate)?u:I,f=o(i),d=f[0],v=f[1],m=s(d);return r(function(){l(d,m)},[m,d]),{query:d,clear:function(){v(i)},onChange:function(e){var t=e.currentTarget.value,r=Boolean(n.enum[String(t)]);v(r?t:void 0)},filterFn:a,options:c,onUpdate:l}}!function(n){n.contracted="contracted",n.expanded="expanded"}(b||(b={})),function(n){n.idle="idle",n.selected="selected",n.error="error"}(E||(E={}));var k=function(n){try{if(!n)return Promise.resolve(D);var e=document.createElement("img"),t=new Promise(function(n,t){e.onload=function(){return n({width:e.width,height:e.height})},e.onerror=t});return e.src=n,Promise.resolve(t)}catch(n){return Promise.reject(n)}},D={width:null,height:null};function R(e){var t=y(D);return n.useEffect(function(){!function(){try{var n,r=function(r){if(n)return r;[E.error,E.idle].includes(e.state)&&null!==t.value.width&&null!==t.value.height&&t.clear()},o=function(){if(e.state===E.selected)return function(r,o){try{var u=Promise.resolve(k(e.actions.previewFile())).then(function(e){var r=t.set(e);return n=1,r})}catch(n){return o()}return u&&u.then?u.then(void 0,o):u}(0,function(){var e=t.clear();return n=1,e})}();Promise.resolve(o&&o.then?o.then(r):r(o))}catch(n){return Promise.reject(n)}}()},[e.state]),t.value}function z(n){void 0===n&&(n=!1);var e=o(n),t=e[0],r=e[1];return{on:t,off:!t,enable:function(){return r(!0)},disable:function(){return r(!1)},toggle:function(){return r(function(n){return!n})}}}var N=function(){var n=z("undefined"==typeof navigator||"boolean"!=typeof navigator.onLine||navigator.onLine);return e.useEffect(function(){function e(){n.enable()}function t(){n.disable()}return window.addEventListener("online",e),window.addEventListener("offline",t),function(){window.removeEventListener("online",e),window.removeEventListener("offline",t)}},[]),n.on};function q(n){e.useEffect(function(){var e=i(window,n);return function(){return e()}},[n])}function H(n){void 0===n&&(n=!1),e.useEffect(function(){if(n)return window.addEventListener("beforeunload",e),function(){return window.removeEventListener("beforeunload",e)};function e(n){n.preventDefault()}},[n])}function Q(n){var e,t,r=null!=(e=null==n?void 0:n.defaultItems)?e:[],u=null!=(t=null==n?void 0:n.comparisonFn)?t:function(n,e){return n===e},i=o(r),a=i[0],c=i[1];function l(n){c(function(e){return Array.isArray(n)?[].concat(e,n):[].concat(e,[n])})}function f(n){c(function(e){return e.filter(function(e){return!u(e,n)})})}function s(n){return a.some(function(e){return u(e,n)})}return[a,{clear:function(){c([])},add:l,remove:f,toggle:function(n){s(n)?f(n):l(n)},isAdded:s,update:c}]}function _(n){void 0===n&&(n=!0),u(function(){if(n){var e=document.querySelector("html"),t=document.body,r=window.getComputedStyle(t).overflow,o=window.getComputedStyle(e).overflow;return t.style.overflow="hidden",e.style.overflow="hidden",function(){t.style.overflow=r,e.style.overflow=o}}},[n])}function B(n){var e=P();return new URLSearchParams(null==e?void 0:e.location.search).get(n.label),U(a({onUpdate:function(t,r){if(e){var o=new URL(e.location.toString()),u=new URLSearchParams(o.search);void 0===t?u.delete(n.label):u.set(n.label,t),t!==r&&t!==r&&(o.search=u.toString(),history.pushState({},"",o.toString()))}}},n,{defaultQuery:n.defaultQuery}))}var V=["DialogOverlay","disable","enable","on","off","toggle"];function W(n){var t=n.DialogOverlay,r=n.disable,o=c(n,V),u=e.useRef(null);return q({Escape:r}),j(u,r),L({ref:u,condition:n.on}),_(n.on),n.off?null:e.createElement(e.Fragment,null,null!=t?t:e.createElement(Y,null),e.createElement("dialog",a({ref:u,tabIndex:0,open:n.on,"data-display":"flex","data-direction":"column","data-position":"absolute","data-z":"2","data-bg":"white","data-br":"4","data-bc":"gray-300","data-bw":"1","data-p":"24","data-mx":"auto"},o)))}function Y(n){return e.createElement("div",a({"data-position":"absolute","data-inset":"0","data-display":"flex","data-main":"cross","data-cross":"center","data-z":"2",style:{background:"rgb(0, 0, 0, 0.75)"}},n))}function $(n){return N()?null:e.createElement(e.Fragment,null,n.children)}var G=["as"];function J(n){var t=n.as,r=c(n,G);return e.createElement(t||"a",a({target:"_blank",rel:"noreferer noopener"},r))}var K=function(n){try{var e,t,r=null!=(e=n.onFailure)?e:X,o=null!=(t=n.onSuccess)?t:I;navigator.clipboard||r();var u=function(e,t){try{var r=Promise.resolve(navigator.clipboard.writeText(n.text)).then(function(){o()})}catch(n){return t(n)}return r&&r.then?r.then(void 0,t):r}(0,function(n){r(n)});return Promise.resolve(u&&u.then?u.then(function(){}):void 0)}catch(n){return Promise.reject(n)}},X=function(n){return console.warn("Copying to clipboard not supported")},Z=/*#__PURE__*/function(){function n(){}return n.datetime=function(n,e){return void 0===e&&(e="N/A"),n?new Date(n).toLocaleString():e},n.form=function(e){return e?String(e.getFullYear()).padStart(2,"0")+"-"+String(e.getMonth()+1).padStart(2,"0")+"-"+String(e.getDate()).padStart(2,"0"):n.form(new Date)},n}(),nn=/*#__PURE__*/function(){function n(n,e){this.value=void 0;var t=new URLSearchParams(this.getNonEmptyFilters(e));this.value=""!==t.toString()?n+"?"+t.toString():n}return n.prototype.getNonEmptyFilters=function(n){return void 0===n?{}:Object.fromEntries(Object.entries(n).filter(function(n){return void 0!==n[1]}))},n}();function en(){return!P()}var tn=/*#__PURE__*/function(){function n(){}return n.extract=function(n){var e,t,r;return null!=(e=null==(t=n.data)||null==(r=t.pages)?void 0:r.flat().map(function(n){return n.result}).flat())?e:[]},n}();function rn(n){var e;if("en"!==n.language)return console.warn("[@bgord/frontend] missing pluralization fuction for language "+n.language+"."),n.singular;var t=null!=(e=n.plural)?e:n.singular+"s";return 1===n.value?n.singular:t}tn.empty={result:[],meta:{exhausted:!0}};var on=/*#__PURE__*/function(){function n(n){this.message=void 0,this._known=!0,this.message=n.message}return n.isServerError=function(n){return!!(n&&"object"==typeof n&&n===Object(n)&&n.hasOwnProperty("_known")&&n.hasOwnProperty("message"))},n.extract=function(e){try{return e.ok?Promise.resolve(e):Promise.resolve(e.json()).then(function(e){var t=n.isServerError(e)?e.message:"app.error.general";throw new n({message:t})})}catch(n){return Promise.reject(n)}},n.handle=function(e){try{throw new n({message:n.isServerError(e)?e.message:"app.error.general"})}catch(n){return Promise.reject(n)}},n}(),un=/*#__PURE__*/function(){function n(n){this.value=void 0,this.value=n}var e=n.prototype;return e.toHours=function(){return 24*this.value},e.toMinutes=function(){return 24*this.value*60},e.toSeconds=function(){return 24*this.value*60*60},e.toMs=function(){return 24*this.value*60*60*1e3},n}(),an=/*#__PURE__*/function(){function n(n){this.value=void 0,this.value=n}var e=n.prototype;return e.toMinutes=function(){return 60*this.value},e.toSeconds=function(){return 60*this.value*60},e.toMs=function(){return 60*this.value*60*1e3},n}(),cn=/*#__PURE__*/function(){function n(n){this.value=void 0,this.value=n}var e=n.prototype;return e.toSeconds=function(){return 60*this.value},e.toMs=function(){return 60*this.value*1e3},n}(),ln=/*#__PURE__*/function(){function n(n){this.value=void 0,this.value=n}return n.prototype.toMs=function(){return 1e3*this.value},n}(),fn={Days:un,Hours:an,Minutes:cn,Seconds:ln},sn=e.createContext(void 0);function dn(n){var t,r,o,u,i=(r=null!=(t=null==n?void 0:n.timeout)?t:5e3,o=Q({comparisonFn:function(n,e){return n.id===e.id}}),u=o[1],[[].concat(o[0]).reverse(),{add:function(n){var e=a({},n,{id:String(Date.now())});u.add(e),setTimeout(function(){return u.remove(e)},r)},remove:u.remove,clear:u.clear}]);return e.createElement(sn.Provider,{value:[i[0],i[1]]},n.children)}function vn(){var n=e.useContext(sn);if(void 0===n)throw new Error("useToasts must be used within the ToastsContextProvider");return n}function mn(){return vn()[1].add}var hn=e.createContext({translations:{},language:"en"});function pn(n){return e.createElement(hn.Provider,{value:n.value},n.children)}function gn(){var n=e.useContext(hn);if(void 0===n)throw new Error("useTranslations must be used within the TranslationsContext");return function(e){var t=n.translations[e];return t||console.warn("[@bgord/frontend] missing translation for key "+e+"."),null!=t?t:e}}function wn(){var n=e.useContext(hn);if(void 0===n)throw new Error("useLanguage must be used within the TranslationsContext");return n.language}function yn(){var n=wn();return function(e){return rn(a({},e,{language:n}))}}export{S as AUDIO_DEFAULT_VOLUME,m as Anima,p as AnimaList,d as AnimaState,Z as DateFormatter,un as Days,Y as DefaultDialogOverlay,W as Dialog,w as DurationFormatter,nn as FilterUrl,an as Hours,cn as Minutes,$ as OfflineIndicator,J as OutboundLink,tn as Pagination,ln as Seconds,on as ServerError,fn as Time,dn as ToastsContextProvider,pn as TranslationsContextProvider,b as UseExpandableListState,E as UseFileState,K as copyToClipboard,D as emptyImageResolution,h as getAnimaProps,k as getImageResolution,P as getSafeWindow,en as isClient,I as noop,rn as pluralize,g as useAnimaList,x as useAudio,L as useAutofocus,F as useBreakpoint,j as useClickOutside,O as useClientSearch,C as useDocumentTitle,M as useExpandableList,y as useField,A as useFile,U as useFilter,R as useImageFileResolution,N as useIsOnline,q as useKeyboardShortcurts,wn as useLanguage,H as useLeavingPrompt,Q as useList,yn as usePluralize,s as usePreviousValue,_ as useScrollLock,mn as useToastTrigger,vn as useToastsContext,z as useToggle,gn as useTranslations,B as useUrlFilter,T as useWindowDimensions};
//# sourceMappingURL=bgord-frontend.module.js.map
